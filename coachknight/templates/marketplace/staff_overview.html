{% extends 'base.html' %}

{% block title %}Staff Overview - CoachKnight{% endblock %}

{% block content %}
<section class="section" style="padding-top: 6rem;">
    <div class="container">
        <h1>Staff Overview</h1>
        <p class="text-muted mb-4">Admin dashboard for CoachKnight</p>
        
        <!-- Stats Cards -->
        <div class="card-grid" style="margin-bottom: 2rem;">
            <div class="card text-center">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--accent);">{{ total_coaches }}</div>
                <div class="text-muted">Total Coaches</div>
            </div>
            <div class="card text-center">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--success);">{{ approved_coaches }}</div>
                <div class="text-muted">Approved</div>
            </div>
            <div class="card text-center">
                <div style="font-size: 2.5rem; font-weight: 700; color: #f59e0b;">{{ new_coaches }}</div>
                <div class="text-muted">Pending Review</div>
            </div>
            <div class="card text-center">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--accent);">{{ vendor_waitlist }}</div>
                <div class="text-muted">Vendor Requests</div>
            </div>
        </div>
        
        <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
            <a href="{% url 'marketplace:staff_coaches' %}" class="btn btn-primary">Review Coaches</a>
            <a href="{% url 'marketplace:staff_coaches' %}?status=new" class="btn btn-secondary">View Pending ({{ new_coaches }})</a>
        </div>
        
        <!-- Recent Coaches -->
        <div class="card mb-3">
            <h3>Recent Coach Signups</h3>
            {% if recent_coaches %}
            <table style="width: 100%; margin-top: 1rem; border-collapse: collapse;">
                <thead>
                    <tr style="border-bottom: 2px solid var(--gray-200);">
                        <th style="text-align: left; padding: 0.75rem 0;">Name</th>
                        <th style="text-align: left; padding: 0.75rem 0;">Town</th>
                        <th style="text-align: left; padding: 0.75rem 0;">Status</th>
                        <th style="text-align: left; padding: 0.75rem 0;">Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for coach in recent_coaches %}
                    <tr style="border-bottom: 1px solid var(--gray-100);">
                        <td style="padding: 0.75rem 0;">{{ coach.display_name }}</td>
                        <td style="padding: 0.75rem 0;">{{ coach.town }}</td>
                        <td style="padding: 0.75rem 0;">
                            {% if coach.status == 'new' %}
                                <span class="badge" style="background: #fef3c7; color: #92400e;">Pending</span>
                            {% elif coach.status == 'approved' %}
                                <span class="badge badge-success">Approved</span>
                            {% else %}
                                <span class="badge">Rejected</span>
                            {% endif %}
                        </td>
                        <td style="padding: 0.75rem 0; color: var(--text-muted);">{{ coach.created_at|date:"M d" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted">No coaches yet.</p>
            {% endif %}
        </div>
        
        <!-- Recent Vendor Waitlist -->
        <div class="card">
            <h3>Recent Vendor Requests</h3>
            {% if recent_vendor_waitlist %}
            <table style="width: 100%; margin-top: 1rem; border-collapse: collapse;">
                <thead>
                    <tr style="border-bottom: 2px solid var(--gray-200);">
                        <th style="text-align: left; padding: 0.75rem 0;">Organization</th>
                        <th style="text-align: left; padding: 0.75rem 0;">Contact</th>
                        <th style="text-align: left; padding: 0.75rem 0;">Towns</th>
                        <th style="text-align: left; padding: 0.75rem 0;">Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for entry in recent_vendor_waitlist %}
                    <tr style="border-bottom: 1px solid var(--gray-100);">
                        <td style="padding: 0.75rem 0;">{{ entry.org_name }}</td>
                        <td style="padding: 0.75rem 0;">{{ entry.contact_name }}<br><small class="text-muted">{{ entry.email }}</small></td>
                        <td style="padding: 0.75rem 0;">{{ entry.towns }}</td>
                        <td style="padding: 0.75rem 0; color: var(--text-muted);">{{ entry.created_at|date:"M d" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted">No vendor requests yet.</p>
            {% endif %}
        </div>
        
    </div>
</section>
{% endblock %}
