{% extends 'mini_insta/base.html' %}

{% block content %}
<main class="grid profile-header">

  <!-- Profile image -->
  <div class="profile-image">
    {% if profile.profile_image_url %}
      <img src="{{ profile.profile_image_url }}" alt="{{ profile.display_name }}">
    {% else %}
      <img src="https://via.placeholder.com/200" alt="No image">
    {% endif %}
  </div>

  <!-- Profile info -->
  <div class="profile-info">
    <div class="profile-header-item">
      <h2>{{ profile.display_name }}</h2>
      <h3>@{{ profile.username }}</h3>
    </div>

    <div class="profile-header-item">
      <p>{{ profile.bio_text }}</p>
    </div>

    <div class="profile-header-item">
      <small>Joined: {{ profile.join_date }}</small>
    </div>
  </div>

  <div>
    <h2>Posts</h2>
    {% for post in profile.get_all_posts %}
      <a href="{% url 'mini_insta:show_post' post.pk %}">
        {% with photo=post.get_all_photos.0 %}
          {% if photo and photo.get_image_url %}
            <img src="{{ photo.get_image_url }}" alt="{{ post.caption }}">
          {% elif post.get_image_url %}
            <img src="{{ post.get_image_url }}" alt="{{ post.caption }}">
          {% else %}
            <img src="https://via.placeholder.com/200" alt="No image">
          {% endif %}
        {% endwith %}
      </a>
    {% empty %}
      <p>No posts yet.</p>
    {% endfor %}
  </div>

<a href="{% url 'mini_insta:update_profile' profile.pk %}" class="button">
  Update Profile
</a>
</main>
{% endblock %}
